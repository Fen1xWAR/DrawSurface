# README

## Описание
Проект представляет собой приложение для конвертации изображений в 3D-карты высот и визуализации рельефа. С его помощью можно выбрать изображение, обработать его, создать файл рельефа (`.fdf`) и визуализировать его в 3D-пространстве с возможностью изменения угла обзора и масштаба. Приложение включает интуитивный графический интерфейс, который упрощает работу с изображениями и файлами карт высот.

## Основные возможности
- **Конвертация изображений в карты высот**: Поддерживает обработку цветных и черно-белых изображений для создания карты высот с рельефом, которая сохраняется в формате `.fdf`.
- **Цветовая интерпретация высот**: При обработке цветных изображений программа анализирует яркость пикселей и конвертирует их в высоты, сохраняя цвета для каждого уровня рельефа. 
- **Автоматическое создание и управление файлами `.fdf`**: Программа автоматически сохраняет карты высот в формате `.fdf` и позволяет управлять этими файлами через интерфейс.
- **Интерактивная визуализация рельефа**: Пользователь может поворачивать карту, увеличивать или уменьшать масштаб, чтобы детально изучить созданный рельеф в 3D.

## Особенности
- **Обработка изображений**: Программа адаптирует высоты рельефа с помощью логарифмической функции для улучшения визуализации, что особенно полезно для изображений с высоким контрастом.
- **Цветовая интерпретация и стандартизированная схема**: Для черно-белых изображений используется предустановленная схема цветов, обеспечивающая понятное отображение низин, возвышенностей и средних уровней рельефа.
- **Гибкость выбора файлов**: Пользователь может либо выбрать изображение для конвертации, либо открыть существующий `.fdf` файл из списка, если карта уже была создана.


## Структура файлов проекта 
### `main.py`
Файл, отвечающий за графический интерфейс и основной запуск программы.
- **Класс `MainWindow`**: Главное окно приложения, которое предоставляет пользователю интерфейс для работы с файлами карт.
  - **Методы**:
    - `create_button(text, callback, layout)`: Создает кнопку и привязывает к ней обработчик.
    - `load_file()`: Открывает диалоговое окно для выбора изображения, отправляет его для конвертации в файл карты высот `.fdf`.
    - `open_file()`: Открывает и визуализирует файл карты высот, выбранный из списка.
    - `load_files()`: Загружает список файлов `.fdf` из указанной папки, чтобы отобразить их в интерфейсе.

### `map_generator.py`
Файл, реализующий функциональность обработки изображений для преобразования их в карты высот в формате `.fdf`.
- **Основные функции**:
 - `get_image(path)`: Загружает изображение из заданного пути, обрабатывает ошибки формата и пути файла.
  - `parse_without_color(image)`: Обрабатывает черно-белые изображения, создавая карту высот с использованием предустановленной цветовой схемы.
  - `change_extension(file_path, new_extension)`: Меняет расширение файла для сохранения в формате `.fdf`.
  - `main(path)`: Главная функция конвертации. Обрабатывает изображение, создает карту высот с логарифмической адаптацией и сохраняет её как `.fdf` файл.
  
### `surface_drawer.py`
Файл для загрузки и отрисовки карт высот с помощью OpenGL. Использует созданные `.fdf` файлы для визуализации рельефа в 3D.
- **Основные функции**:
  - `load_fdf_file(filename)`: Загружает `.fdf` файл и преобразует его в матрицу высот и цветов для 3D-отрисовки.
  - `create_vertices_and_colors(matrix, scale_z)`: Создает массивы вершин и цветов, которые будут использованы для отображения рельефа.
  - `draw_plane(vertices, colors, edges)`: Отрисовывает рельеф, используя OpenGL.
  - `main_program(matrix)`: Основная функция, запускающая визуализацию карты высот с возможностью вращения и масштабирования.

### `test_maps`
Каталог, используемый для хранения файлов карт высот `.fdf`. Этот каталог автоматически загружается в интерфейсе для отображения и быстрого доступа к уже созданным картам.

### Дополнительные файлы и зависимости
- **Библиотеки**: Программа требует установки нескольких библиотек, включая `numpy`, `Pillow`, `PyQt6`, `pygame`, и `pyopengl`. Они необходимы для обработки изображений, создания графического интерфейса и визуализации в 3D. Команды для установки в терминале  библиотек написаны в разделе установка:

  ## Установка
Для работы проекта необходимо установить следующие библиотеки:
```bash
pip install numpy pygame pyopengl pyqt6 pillow
```

## Использование
1. **Запуск приложения**:
   ```bash
   python main.py
   ```
2. **Загрузка изображения**:
   - В интерфейсе нажмите «Загрузить файл» и выберите изображение (форматы: `.jpg`, `.png`, `.jpeg`).
   ![Иллюстрация к проекту](https://github.com/Fen1xWAR/DrawSurface/blob/08f22e5fa33fad0c22193c20a1819e5892cee593/image/Open_file.png)
   - Программа автоматически создаст карту рельефа, сохранит её в формате `.fdf` и отобразит в 3D.
3. **Открытие карты высот из предложеного католога**:
   - Выберите `.fdf` файл из списка загруженных карт и нажмите «Открыть» для отображения карты рельефа.
   ![Иллюстрация к проекту](https://github.com/Fen1xWAR/DrawSurface/blob/08f22e5fa33fad0c22193c20a1819e5892cee593/image/Open_fdf.png)
4. **Отрисовка карты высот**:
   ![Иллюстрация к проекту](https://github.com/Fen1xWAR/DrawSurface/blob/b1db2f30990040a5814860e9fe6ad0d8b9f9b556/image/relief_map2.png)

## Управление
- **Вращение карты**: Нажмите и удерживайте левую кнопку мыши, чтобы поворачивать карту.
- **Масштабирование**: Используйте колесо мыши для увеличения или уменьшения масштаба карты.

## Обработка ошибок
- **Неверный формат изображения**: Если изображение не поддерживается, программа отобразит сообщение об ошибке, предложив выбрать другой файл.
- **Отсутствие файлов**: Если папка `test_maps` пуста или недоступна, программа выведет соответствующее уведомление.

## Лицензия
Проект распространяется по лицензии MIT.
